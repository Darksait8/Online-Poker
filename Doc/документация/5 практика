ЛОГИЧЕСКАЯ МОДЕЛЬ БАЗЫ ДАННЫХ — Online Poker

1. Перечень сущностей и их атрибутов (логический уровень)
- Пользователь (Player)
  • player_id (UUID) — ключ
  • login (varchar, уник.)
  • email (varchar, уник.)
  • password_hash (varchar)
  • nickname (varchar, уник.)
  • locale (varchar)
  • balance (decimal)
  • created_at (timestamp)
  • updated_at (timestamp)

- Профиль (PlayerProfile)
  • profile_id (UUID) — ключ
  • player_id (FK → Player)
  • avatar_url (varchar)
  • privacy_level (enum: public/friends/private)
  • bio (varchar)
  • settings_json (json) — графика/звук/язык/карты
  • updated_at (timestamp)

- Друзья (Friendship)
  • player_id (FK → Player)
  • friend_id (FK → Player)
  • status (enum: pending/accepted/blocked)
  • created_at (timestamp)
  • PRIMARY KEY (player_id, friend_id)

- Стол (Table)
  • table_id (UUID) — ключ
  • name (varchar)
  • limit_small_blind (decimal)
  • limit_big_blind (decimal)
  • max_players (int)
  • status (enum: open/playing/closed)
  • is_private (bool)
  • owner_player_id (FK → Player, nullable)
  • created_at (timestamp)

- Сессия стола (TableSeat)
  • table_id (FK → Table)
  • seat_no (int)
  • player_id (FK → Player, nullable)
  • buy_in (decimal, nullable)
  • is_sitting_out (bool)
  • PRIMARY KEY (table_id, seat_no)

- Раздача (Hand)
  • hand_id (UUID) — ключ
  • table_id (FK → Table)
  • dealer_seat_no (int)
  • started_at (timestamp)
  • finished_at (timestamp, nullable)
  • pot_total (decimal)

- Блайнды/ставки по улицам (StreetState)
  • hand_id (FK → Hand)
  • street (enum: preflop/flop/turn/river)
  • current_bet (decimal)
  • pot_at_start (decimal)
  • PRIMARY KEY (hand_id, street)

- Ход/Действие (ActionLog)
  • action_id (UUID) — ключ
  • hand_id (FK → Hand)
  • street (enum)
  • player_id (FK → Player)
  • seat_no (int)
  • action_type (enum: fold/check/call/bet/raise/allin/post_sb/post_bb)
  • amount (decimal, nullable)
  • created_at (timestamp)

- Банки (Pot)
  • pot_id (UUID) — ключ
  • hand_id (FK → Hand)
  • pot_type (enum: main/side)
  • amount (decimal)

- Вклады в банк (PotContribution)
  • pot_id (FK → Pot)
  • player_id (FK → Player)
  • amount (decimal)
  • PRIMARY KEY (pot_id, player_id)

- Карты в раздаче (HandCards)
  • hand_id (FK → Hand)
  • player_id (FK → Player)
  • card1 (char(2))
  • card2 (char(2))
  • PRIMARY KEY (hand_id, player_id)

- Общие карты (Board)
  • hand_id (FK → Hand)
  • flop1 (char(2), nullable)
  • flop2 (char(2), nullable)
  • flop3 (char(2), nullable)
  • turn (char(2), nullable)
  • river (char(2), nullable)
  • PRIMARY KEY (hand_id)

- Результаты раздачи (HandResult)
  • hand_id (FK → Hand)
  • player_id (FK → Player)
  • final_hand_rank (int) — сила комбинации
  • winnings (decimal)
  • PRIMARY KEY (hand_id, player_id)

- Транзакция баланса (WalletTransaction)
  • tx_id (UUID) — ключ
  • player_id (FK → Player)
  • tx_type (enum: topup/withdraw/buyin/payout/bonus)
  • amount (decimal)
  • status (enum: pending/success/failed)
  • created_at (timestamp)
  • metadata_json (json)

- Платёж (Payment)
  • payment_id (UUID) — ключ
  • player_id (FK → Player)
  • method (enum: card/emoney/bank)
  • amount (decimal)
  • status (enum: initiated/success/failed/cancelled)
  • provider_ref (varchar)
  • created_at (timestamp)
  • updated_at (timestamp)

2. Ключевые связи (кардинальности)
- Player 1 — 1 PlayerProfile
- Player 1 — N WalletTransaction
- Player 1 — N Payment
- Player 1 — N TableSeat (через время)
- Player N — M Player (через Friendship)
- Table 1 — N TableSeat
- Table 1 — N Hand
- Hand 1 — 1 Board
- Hand 1 — N StreetState
- Hand 1 — N ActionLog
- Hand 1 — N Pot
- Pot 1 — N PotContribution
- Hand 1 — N HandResult
- Hand N — M Player (через HandCards, HandResult)

3. Нормализация и инварианты
- 3НФ для справочников и логов; суммы считаются агрегатами из ActionLog/PotContribution.
- Инварианты: сумма Pot.amount = Σ(PotContribution.amount) по pot_id; Σ выигрышей = PotTotal; баланс игрока = сумма WalletTransaction (успешных).

ER-диаграмма (Mermaid)
```mermaid
erDiagram
    Player ||--o{ PlayerProfile : has
    Player ||--o{ WalletTransaction : makes
    Player ||--o{ Payment : initiates
    Player ||--o{ TableSeat : sits
    Player ||--o{ Friendship : relates
    Player ||--o{ HandCards : holds
    Player ||--o{ ActionLog : acts
    Player ||--o{ HandResult : receives

    Friendship }o--|| Player : friend

    Table ||--o{ TableSeat : has
    Table ||--o{ Hand : hosts

    Hand ||--|| Board : has
    Hand ||--o{ StreetState : tracks
    Hand ||--o{ ActionLog : records
    Hand ||--o{ Pot : aggregates
    Hand ||--o{ HandCards : deals
    Hand ||--o{ HandResult : yields

    Pot ||--o{ PotContribution : collects

    Player {
        UUID player_id
        string login
        string email
        string password_hash
        string nickname
        string locale
        decimal balance
        datetime created_at
        datetime updated_at
    }
    Table {
        UUID table_id
        string name
        decimal limit_small_blind
        decimal limit_big_blind
        int max_players
        enum status
        bool is_private
        UUID owner_player_id
        datetime created_at
    }
    Hand {
        UUID hand_id
        UUID table_id
        int dealer_seat_no
        datetime started_at
        datetime finished_at
        decimal pot_total
    }
```

Стартовый SQL DDL (PostgreSQL)
```sql
CREATE TYPE privacy_level AS ENUM ('public','friends','private');
CREATE TYPE table_status AS ENUM ('open','playing','closed');
CREATE TYPE street AS ENUM ('preflop','flop','turn','river');
CREATE TYPE action_type AS ENUM ('fold','check','call','bet','raise','allin','post_sb','post_bb');
CREATE TYPE tx_type AS ENUM ('topup','withdraw','buyin','payout','bonus');
CREATE TYPE tx_status AS ENUM ('pending','success','failed');
CREATE TYPE payment_method AS ENUM ('card','emoney','bank');
CREATE TYPE payment_status AS ENUM ('initiated','success','failed','cancelled');

CREATE TABLE player (
  player_id UUID PRIMARY KEY,
  login TEXT UNIQUE NOT NULL,
  email TEXT UNIQUE NOT NULL,
  password_hash TEXT NOT NULL,
  nickname TEXT UNIQUE NOT NULL,
  locale TEXT DEFAULT 'ru',
  balance NUMERIC(18,2) DEFAULT 0,
  created_at TIMESTAMP DEFAULT now(),
  updated_at TIMESTAMP DEFAULT now()
);

CREATE TABLE player_profile (
  profile_id UUID PRIMARY KEY,
  player_id UUID NOT NULL REFERENCES player(player_id) ON DELETE CASCADE,
  avatar_url TEXT,
  privacy_level privacy_level DEFAULT 'public',
  bio TEXT,
  settings_json JSONB,
  updated_at TIMESTAMP DEFAULT now(),
  UNIQUE(player_id)
);

CREATE TABLE friendship (
  player_id UUID REFERENCES player(player_id) ON DELETE CASCADE,
  friend_id UUID REFERENCES player(player_id) ON DELETE CASCADE,
  status TEXT CHECK (status IN ('pending','accepted','blocked')),
  created_at TIMESTAMP DEFAULT now(),
  PRIMARY KEY (player_id, friend_id)
);

CREATE TABLE game_table (
  table_id UUID PRIMARY KEY,
  name TEXT,
  limit_small_blind NUMERIC(18,2) NOT NULL,
  limit_big_blind NUMERIC(18,2) NOT NULL,
  max_players INT NOT NULL CHECK (max_players BETWEEN 2 AND 10),
  status table_status DEFAULT 'open',
  is_private BOOLEAN DEFAULT FALSE,
  owner_player_id UUID REFERENCES player(player_id),
  created_at TIMESTAMP DEFAULT now()
);

CREATE TABLE table_seat (
  table_id UUID REFERENCES game_table(table_id) ON DELETE CASCADE,
  seat_no INT NOT NULL,
  player_id UUID REFERENCES player(player_id),
  buy_in NUMERIC(18,2),
  is_sitting_out BOOLEAN DEFAULT FALSE,
  PRIMARY KEY (table_id, seat_no)
);

CREATE TABLE hand (
  hand_id UUID PRIMARY KEY,
  table_id UUID NOT NULL REFERENCES game_table(table_id) ON DELETE CASCADE,
  dealer_seat_no INT NOT NULL,
  started_at TIMESTAMP DEFAULT now(),
  finished_at TIMESTAMP,
  pot_total NUMERIC(18,2) DEFAULT 0
);

CREATE TABLE street_state (
  hand_id UUID REFERENCES hand(hand_id) ON DELETE CASCADE,
  street street NOT NULL,
  current_bet NUMERIC(18,2) DEFAULT 0,
  pot_at_start NUMERIC(18,2) DEFAULT 0,
  PRIMARY KEY (hand_id, street)
);

CREATE TABLE action_log (
  action_id UUID PRIMARY KEY,
  hand_id UUID NOT NULL REFERENCES hand(hand_id) ON DELETE CASCADE,
  street street NOT NULL,
  player_id UUID NOT NULL REFERENCES player(player_id),
  seat_no INT NOT NULL,
  action_type action_type NOT NULL,
  amount NUMERIC(18,2),
  created_at TIMESTAMP DEFAULT now()
);

CREATE TABLE pot (
  pot_id UUID PRIMARY KEY,
  hand_id UUID NOT NULL REFERENCES hand(hand_id) ON DELETE CASCADE,
  pot_type TEXT CHECK (pot_type IN ('main','side')) NOT NULL,
  amount NUMERIC(18,2) DEFAULT 0
);

CREATE TABLE pot_contribution (
  pot_id UUID REFERENCES pot(pot_id) ON DELETE CASCADE,
  player_id UUID REFERENCES player(player_id) ON DELETE CASCADE,
  amount NUMERIC(18,2) NOT NULL,
  PRIMARY KEY (pot_id, player_id)
);

CREATE TABLE hand_cards (
  hand_id UUID REFERENCES hand(hand_id) ON DELETE CASCADE,
  player_id UUID REFERENCES player(player_id) ON DELETE CASCADE,
  card1 CHAR(2) NOT NULL,
  card2 CHAR(2) NOT NULL,
  PRIMARY KEY (hand_id, player_id)
);

CREATE TABLE board (
  hand_id UUID PRIMARY KEY REFERENCES hand(hand_id) ON DELETE CASCADE,
  flop1 CHAR(2),
  flop2 CHAR(2),
  flop3 CHAR(2),
  turn CHAR(2),
  river CHAR(2)
);

CREATE TABLE hand_result (
  hand_id UUID REFERENCES hand(hand_id) ON DELETE CASCADE,
  player_id UUID REFERENCES player(player_id) ON DELETE CASCADE,
  final_hand_rank INT,
  winnings NUMERIC(18,2) DEFAULT 0,
  PRIMARY KEY (hand_id, player_id)
);

CREATE TABLE wallet_transaction (
  tx_id UUID PRIMARY KEY,
  player_id UUID NOT NULL REFERENCES player(player_id) ON DELETE CASCADE,
  tx_type tx_type NOT NULL,
  amount NUMERIC(18,2) NOT NULL,
  status tx_status NOT NULL,
  created_at TIMESTAMP DEFAULT now(),
  metadata_json JSONB
);

CREATE TABLE payment (
  payment_id UUID PRIMARY KEY,
  player_id UUID NOT NULL REFERENCES player(player_id) ON DELETE CASCADE,
  method payment_method NOT NULL,
  amount NUMERIC(18,2) NOT NULL,
  status payment_status NOT NULL,
  provider_ref TEXT,
  created_at TIMESTAMP DEFAULT now(),
  updated_at TIMESTAMP DEFAULT now()
);


ЛОГИЧЕСКАЯ МОДЕЛЬ В ВИДЕ ТАБЛИЦ (для отчёта)

Таблица: Player (Пользователь)
| Поле           | Тип            | Ключ | NULL | Описание                          |
|----------------|----------------|------|------|-----------------------------------|
| player_id      | UUID           | PK   | NO   | Идентификатор пользователя        |
| login          | TEXT           | UQ   | NO   | Логин                             |
| email          | TEXT           | UQ   | NO   | Email                             |
| password_hash  | TEXT           |      | NO   | Хэш пароля                        |
| nickname       | TEXT           | UQ   | NO   | Отображаемое имя                  |
| locale         | TEXT           |      | YES  | Язык интерфейса                   |
| balance        | NUMERIC(18,2)  |      | NO   | Баланс                            |
| created_at     | TIMESTAMP      |      | NO   | Дата создания                     |
| updated_at     | TIMESTAMP      |      | NO   | Дата обновления                   |

Таблица: PlayerProfile (Профиль)
| Поле          | Тип       | Ключ | NULL | Описание                         |
|---------------|-----------|------|------|----------------------------------|
| profile_id    | UUID      | PK   | NO   | Идентификатор профиля            |
| player_id     | UUID      | FK   | NO   | → Player.player_id               |
| avatar_url    | TEXT      |      | YES  | URL аватара                      |
| privacy_level | ENUM      |      | NO   | public/friends/private           |
| bio           | TEXT      |      | YES  | О себе                           |
| settings_json | JSONB     |      | YES  | Настройки UI/аудио/карты         |
| updated_at    | TIMESTAMP |      | NO   | Дата обновления                  |

Таблица: Friendship (Друзья)
| Поле       | Тип  | Ключ | NULL | Описание                     |
|------------|------|------|------|------------------------------|
| player_id  | UUID | PK,F | NO   | → Player.player_id           |
| friend_id  | UUID | PK,F | NO   | → Player.player_id           |
| status     | TEXT |      | NO   | pending/accepted/blocked     |
| created_at | TS   |      | NO   | Дата создания связи          |

Таблица: GameTable (Стол)
| Поле              | Тип            | Ключ | NULL | Описание                       |
|-------------------|----------------|------|------|--------------------------------|
| table_id          | UUID           | PK   | NO   | Идентификатор стола            |
| name              | TEXT           |      | YES  | Название стола                 |
| limit_small_blind | NUMERIC(18,2)  |      | NO   | Малый блайнд                   |
| limit_big_blind   | NUMERIC(18,2)  |      | NO   | Большой блайнд                 |
| max_players       | INT            |      | NO   | Максимум игроков (2..10)       |
| status            | ENUM           |      | NO   | open/playing/closed            |
| is_private        | BOOLEAN        |      | NO   | Приватный стол                 |
| owner_player_id   | UUID           | FK   | YES  | → Player.player_id             |
| created_at        | TIMESTAMP      |      | NO   | Дата создания                  |

Таблица: TableSeat (Места стола)
| Поле       | Тип   | Ключ | NULL | Описание                           |
|------------|-------|------|------|------------------------------------|
| table_id   | UUID  | PK,F | NO   | → GameTable.table_id               |
| seat_no    | INT   | PK   | NO   | Номер места                        |
| player_id  | UUID  | FK   | YES  | → Player.player_id (если занят)    |
| buy_in     | NUM   |      | YES  | Сумма входа                        |
| is_sitting_out | BOOL |   | NO   | Пропускает ходы                    |

Таблица: Hand (Раздача)
| Поле          | Тип       | Ключ | NULL | Описание                     |
|---------------|-----------|------|------|------------------------------|
| hand_id       | UUID      | PK   | NO   | Идентификатор раздачи        |
| table_id      | UUID      | FK   | NO   | → GameTable.table_id         |
| dealer_seat_no| INT       |      | NO   | Кнопка дилера (seat_no)      |
| started_at    | TIMESTAMP |      | NO   | Время начала                 |
| finished_at   | TIMESTAMP |      | YES  | Время окончания              |
| pot_total     | NUM(18,2) |      | NO   | Общая сумма банка            |

Таблица: StreetState (Состояние улицы)
| Поле        | Тип    | Ключ | NULL | Описание                       |
|-------------|--------|------|------|--------------------------------|
| hand_id     | UUID   | PK,F | NO   | → Hand.hand_id                 |
| street      | ENUM   | PK   | NO   | preflop/flop/turn/river        |
| current_bet | NUM    |      | NO   | Текущая ставка на улице        |
| pot_at_start| NUM    |      | NO   | Банк на начало улицы           |

Таблица: ActionLog (Журнал действий)
| Поле       | Тип    | Ключ | NULL | Описание                                  |
|------------|--------|------|------|-------------------------------------------|
| action_id  | UUID   | PK   | NO   | Идентификатор действия                    |
| hand_id    | UUID   | FK   | NO   | → Hand.hand_id                            |
| street     | ENUM   |      | NO   | Улица (preflop/flop/turn/river)          |
| player_id  | UUID   | FK   | NO   | → Player.player_id                        |
| seat_no    | INT    |      | NO   | Место игрока                              |
| action_type| ENUM   |      | NO   | fold/check/call/bet/raise/allin/post_sb/bb|
| amount     | NUM    |      | YES  | Сумма (для bet/raise/call и т.п.)         |
| created_at | TS     |      | NO   | Время                                     |

Таблица: Pot (Банк)
| Поле    | Тип   | Ключ | NULL | Описание                         |
|---------|-------|------|------|----------------------------------|
| pot_id  | UUID  | PK   | NO   | Идентификатор банка              |
| hand_id | UUID  | FK   | NO   | → Hand.hand_id                   |
| pot_type| TEXT  |      | NO   | main/side                        |
| amount  | NUM   |      | NO   | Сумма в данном банке             |

Таблица: PotContribution (Вклады в банк)
| Поле      | Тип  | Ключ | NULL | Описание                 |
|-----------|------|------|------|--------------------------|
| pot_id    | UUID | PK,F | NO   | → Pot.pot_id             |
| player_id | UUID | PK,F | NO   | → Player.player_id       |
| amount    | NUM  |      | NO   | Вклад игрока             |

Таблица: HandCards (Карманные карты)
| Поле     | Тип   | Ключ | NULL | Описание                 |
|----------|-------|------|------|--------------------------|
| hand_id  | UUID  | PK,F | NO   | → Hand.hand_id           |
| player_id| UUID  | PK,F | NO   | → Player.player_id       |
| card1    | CHAR(2)|     | NO   | Первая карта             |
| card2    | CHAR(2)|     | NO   | Вторая карта             |

Таблица: Board (Общие карты)
| Поле   | Тип    | Ключ | NULL | Описание                 |
|--------|--------|------|------|--------------------------|
| hand_id| UUID   | PK,F | NO   | → Hand.hand_id           |
| flop1  | CHAR(2)|      | YES  | К1 флопа                 |
| flop2  | CHAR(2)|      | YES  | К2 флопа                 |
| flop3  | CHAR(2)|      | YES  | К3 флопа                 |
| turn   | CHAR(2)|      | YES  | Тёрн                     |
| river  | CHAR(2)|      | YES  | Ривер                    |

Таблица: HandResult (Итоги раздачи)
| Поле           | Тип   | Ключ | NULL | Описание               |
|----------------|-------|------|------|------------------------|
| hand_id        | UUID  | PK,F | NO   | → Hand.hand_id         |
| player_id      | UUID  | PK,F | NO   | → Player.player_id     |
| final_hand_rank| INT   |      | NO   | Сила комбинации        |
| winnings       | NUM   |      | NO   | Выигрыш                |

Таблица: WalletTransaction (Транзакции баланса)
| Поле        | Тип   | Ключ | NULL | Описание                   |
|-------------|-------|------|------|----------------------------|
| tx_id       | UUID  | PK   | NO   | Идентификатор транзакции   |
| player_id   | UUID  | FK   | NO   | → Player.player_id         |
| tx_type     | ENUM  |      | NO   | topup/withdraw/buyin/...   |
| amount      | NUM   |      | NO   | Сумма                      |
| status      | ENUM  |      | NO   | pending/success/failed     |
| created_at  | TS    |      | NO   | Дата создания              |
| metadata_json| JSONB|      | YES  | Доп. данные провайдера     |

Таблица: Payment (Платёж)
| Поле        | Тип   | Ключ | NULL | Описание                        |
|-------------|-------|------|------|---------------------------------|
| payment_id  | UUID  | PK   | NO   | Идентификатор платежа           |
| player_id   | UUID  | FK   | NO   | → Player.player_id              |
| method      | ENUM  |      | NO   | card/emoney/bank                |
| amount      | NUM   |      | NO   | Сумма                           |
| status      | ENUM  |      | NO   | initiated/success/failed/cancel |
| provider_ref| TEXT  |      | YES  | Ссылка провайдера               |
| created_at  | TS    |      | NO   | Дата создания                   |
| updated_at  | TS    |      | NO   | Дата обновления                 |


УПРОЩЁННОЕ ОПИСАНИЕ ПОЛЕЙ (для отчёта в стиле: Наименование столбца | Тип данных | Описание)

Таблица 2.x — Player (Пользователь)
| Наименование столбца | Тип данных | Описание |
|----------------------|-----------|----------|
| Идентификатор (player_id) | Текст | Уникальный идентификатор пользователя |
| Логин (login) | Текст | Учётное имя пользователя |
| Электронная почта (email) | Текст | Email пользователя |
| Пароль (password_hash) | Текст | Хэш пароля |
| Никнейм (nickname) | Текст | Отображаемое имя |
| Язык (locale) | Текст | Предпочитаемый язык интерфейса |
| Баланс (balance) | Число | Текущий баланс |
| Дата создания (created_at) | Дата | Дата и время регистрации |
| Дата обновления (updated_at) | Дата | Последнее изменение записи |

Таблица 2.x — GameTable (Стол)
| Наименование столбца | Тип данных | Описание |
|----------------------|-----------|----------|
| Идентификатор (table_id) | Текст | Уникальный идентификатор стола |
| Название (name) | Текст | Название стола |
| Малый блайнд (small_blind) | Число | Размер малого блайнда |
| Большой блайнд (big_blind) | Число | Размер большого блайнда |
| Максимум игроков (max_players) | Число | Количество мест за столом |
| Статус (status) | Текст | Состояние стола: open/playing/closed |
| Приватный (is_private) | Логический | Приватный ли стол |
| Владелец (owner_player_id) | Текст | Идентификатор владельца (если есть) |
| Дата создания (created_at) | Дата | Время создания стола |

Таблица 2.x — Hand (Раздача)
| Наименование столбца | Тип данных | Описание |
|----------------------|-----------|----------|
| Идентификатор (hand_id) | Текст | Уникальный идентификатор раздачи |
| Стол (table_id) | Текст | Ссылка на стол |
| Позиция дилера (dealer_seat_no) | Число | Номер места дилера |
| Начата (started_at) | Дата | Время начала раздачи |
| Завершена (finished_at) | Дата | Время окончания раздачи |
| Общий банк (pot_total) | Число | Итоговая сумма банка |

Таблица 2.x — ActionLog (Журнал действий)
| Наименование столбца | Тип данных | Описание |
|----------------------|-----------|----------|
| Идентификатор (action_id) | Текст | Уникальный идентификатор действия |
| Раздача (hand_id) | Текст | Ссылка на раздачу |
| Улица (street) | Текст | Этап: preflop/flop/turn/river |
| Игрок (player_id) | Текст | Ссылка на игрока |
| Место (seat_no) | Число | Номер места игрока |
| Действие (action_type) | Текст | Тип действия: fold/check/call/bet/raise/allin/post_sb/post_bb |
| Сумма (amount) | Число | Сумма ставки/уравнивания (если есть) |
| Время (created_at) | Дата | Время совершения действия |

Таблица 2.x — WalletTransaction (Транзакции баланса)
| Наименование столбца | Тип данных | Описание |
|----------------------|-----------|----------|
| Идентификатор (tx_id) | Текст | Уникальный идентификатор транзакции |
| Игрок (player_id) | Текст | Ссылка на пользователя |
| Тип (tx_type) | Текст | topup/withdraw/buyin/payout/bonus |
| Сумма (amount) | Число | Сумма транзакции |
| Статус (status) | Текст | pending/success/failed |
| Дата (created_at) | Дата | Время создания транзакции |
| Метаданные (metadata_json) | Текст | Дополнительные данные провайдера |

Таблица 2.x — Payment (Платёж)
| Наименование столбца | Тип данных | Описание |
|----------------------|-----------|----------|
| Идентификатор (payment_id) | Текст | Уникальный идентификатор платежа |
| Игрок (player_id) | Текст | Ссылка на пользователя |
| Метод (method) | Текст | card/emoney/bank |
| Сумма (amount) | Число | Сумма платежа |
| Статус (status) | Текст | initiated/success/failed/cancelled |
| Ссылка провайдера (provider_ref) | Текст | Идентификатор у платёжного провайдера |
| Создан (created_at) | Дата | Время создания |
| Обновлён (updated_at) | Дата | Время обновления |

Примечание: типы приведены в упрощённом виде (Текст/Число/Дата/Логический) для удобства оформления отчёта; в реальной БД используются соответствующие типы СУБД (UUID, NUMERIC, TIMESTAMP и т.п.).
