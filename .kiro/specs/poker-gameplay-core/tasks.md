# План реализации основного геймплея покера

- [x] 1. Настройка отображения карт



  - Нарезать спрайты карт из CuteCards.png на отдельные карты
  - Реализовать CardSpriteProvider.GetSprite() для маппинга Card → Sprite
  - Протестировать отображение реальных карт вместо рубашек
  - _Требования: 1.1, 1.2, 1.3_

- [ ] 2. Создание модели игроков и стола
  - [x] 2.1 Создать класс Player с основными свойствами



    - Реализовать Player с Id, Name, Stack, CurrentBet, HoleCards, Status, SeatIndex
    - Добавить перечисление PlayerStatus (Active, Folded, AllIn, SittingOut)



    - _Требования: 2.1_

  - [x] 2.2 Создать GameManager как основной контроллер



    - Реализовать GameManager с управлением списком игроков
    - Добавить отслеживание DealerIndex, CurrentPlayerIndex, Pot, CurrentBet
    - Интегрировать с существующим GameStateMachine
    - _Требования: 2.1, 2.2, 2.3_




  - [ ] 2.3 Связать UI мест с моделями игроков
    - Модифицировать SeatsLayoutRadial для работы с Player объектами
    - Обновить NewBehaviourScript для отображения данных Player
    - Добавить синхронизацию UI при изменении состояния игроков
    - _Требования: 2.1, 2.2, 2.3_

- [ ] 3. Реализация системы блайндов
  - [ ] 3.1 Добавить логику постановки блайндов
    - Реализовать автоматическую постановку малого блайнда слева от дилера
    - Добавить постановку большого блайнда со следующего игрока
    - Списывать суммы блайндов со стеков игроков
    - _Требования: 3.1, 3.2, 3.3_

  - [x] 3.2 Интегрировать блайнды с началом раздачи





    - Модифицировать GameStateMachine.StartHand() для постановки блайндов
    - Обновить UI отображение ставок после постановки блайндов
    - _Требования: 3.1, 3.2, 3.3_

- [ ] 4. Создание системы очередности ходов
  - [ ] 4.1 Реализовать TurnManager
    - Создать TurnManager с отслеживанием текущего игрока
    - Добавить таймер хода (30 секунд) с автоматическим фолдом
    - Реализовать переход хода к следующему игроку
    - _Требования: 4.1, 4.2, 4.3, 8.1, 8.2, 8.3_

  - [ ] 4.2 Интегрировать с панелью действий
    - Модифицировать ActionPanelController для активации только на ходу игрока
    - Заблокировать панель для игроков не на ходу
    - Добавить визуальную индикацию активного игрока
    - _Требования: 4.1, 4.2_

  - [ ] 4.3 Реализовать завершение раундов торговли
    - Добавить проверку завершения раунда торговли
    - Реализовать переход к следующей улице или шоудауну
    - _Требования: 4.4_

- [ ] 5. Система ставок и банка
  - [ ] 5.1 Создать BettingManager
    - Реализовать валидацию действий (CanCheck, CanCall, CanRaise)
    - Добавить расчет суммы для колла (GetCallAmount)
    - Реализовать обработку ставок (ProcessBet)
    - _Требования: 5.1, 5.2, 5.3, 5.4_

  - [ ] 5.2 Интегрировать с ActionPanelController
    - Подключить BettingManager к обработке действий игрока
    - Добавить валидацию ставок перед их обработкой
    - Реализовать обновление UI после каждого действия
    - _Требования: 5.1, 5.2, 5.3, 5.4, 5.5_

  - [ ] 5.3 Обновление отображения стеков и банка
    - Модифицировать UI для отображения текущих стеков игроков
    - Добавить отображение размера банка
    - Обновлять отображение ставок в реальном времени
    - _Требования: 5.5_

- [ ] 6. Определение победителя
  - [ ] 6.1 Создать HandEvaluator
    - Реализовать перечисление HandRank с покерными комбинациями
    - Создать метод EvaluateHand для оценки руки игрока
    - Добавить сравнение рук для определения победителя
    - _Требования: 6.1, 6.2_

  - [ ] 6.2 Реализовать шоудаун
    - Добавить логику шоудауна в GameStateMachine
    - Определять победителя и распределять банк
    - Обрабатывать случаи разделения банка при равных руках
    - _Требования: 6.1, 6.2, 6.3, 6.4_

- [ ] 7. Переходы между раздачами
  - [ ] 7.1 Реализовать ротацию дилера
    - Добавить сдвиг позиции дилера после каждой раздачи
    - Обновить UI индикацию дилера
    - _Требования: 7.1, 7.2_

  - [ ] 7.2 Автоматический запуск новых раздач
    - Реализовать автоматическое начало новой раздачи
    - Добавить обработку игроков без фишек
    - _Требования: 7.2, 7.3_

- [ ]* 8. Модульные тесты основной логики
  - Написать тесты для HandEvaluator (все покерные комбинации)
  - Создать тесты для BettingManager (валидация ставок)
  - Добавить тесты для TurnManager (таймеры и переходы)
  - _Требования: все_

- [ ]* 9. Интеграционные тесты геймплея
  - Протестировать полный цикл раздачи от начала до конца
  - Проверить различные сценарии (All-In, Fold, Split Pot)
  - Валидировать корректность UI обновлений
  - _Требования: все_